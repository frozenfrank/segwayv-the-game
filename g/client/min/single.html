<script>
function Mothership(){return updateSome(new robot,{name:"Mothership",appearance:{shape:["v2.1",{src:"/g/assets/images/robots/orange/tribase3.png"}],rotateAdjust:-15,sizeChangeSpeed:{2:1.5*variables.sizeScale}},gamePlay:{weaponKeywords:["Shotgun"],damageMultiplier:7,maxShields:2E3,shieldRegen:8,shieldBurnOut:90,rotateSpeed:2,maxHP:15E3,attackThreshold:85,projectileSpeed:.9,robotValue:10,attackRange:900,spawns:["Sentry","Destroyer","MiniCruiser"]},physics:{mass:1500},user:{username:"MOTHERSHIP"},ai:{stateStack:["wander"],
states:{attack:function(){},wander:function(){var a=AI.user,b=a.me.ai;a.distanceToUser.isLow?b.addState("flee"):a.myShields.value<a.me.gamePlay.attackThreshold?b.addState("attack"):AI.count.total<AI.config.maxRobots&&b.changeState("spawn")},spawn:function(){var a=AI.user,b=a.me.ai;AI.steering.wander();a.myShields.value<a.me.gamePlay.attackThreshold?b.addState("attack"):AI.count.total>=AI.config.maxRobots&&b.changeState("wander")},flee:function(){var a=AI.user,b=a.me.ai;a.distanceToUser.isMedium&&
b.removeState()}}},fireWeapon:function(){this.gamePlay.weapons[0].fire({damage:this.gamePlay.damageMultiplier,speed:this.gamePlay.projectileSpeed,immuneTo:["robot"]});this.ai.removeState()}})}
var variables,stopListeningToObjectsRef,$,authObject,functions,AI={user:{stateLog:document.getElementById("stateLog"),breakDown:function(a,b,c){return{isMassive:b>a.high,isHigh:a.high>=b&&b>a.medium,isMedium:a.medium>=b&&b>a.low,isLow:a.low>=b,value:c||b}},get:function(a){var b=variables,c=AI.user,d=AI.config.ranges,e=a.appearance,k=e.position,l=a.gamePlay,g=b.interactingObjects[b.activeUser],b=g.appearance.position,g=g.gamePlay,h=getStandardAngle(k[0],k[1],b[0],b[1])-180,e=e.rotate-h;c.me=a;c.userHP=
this.breakDown(d.health,g.HP/g.maxHP*100);c.userShields=this.breakDown(d.health,g.shields/g.maxShields*100);c.myHP=this.breakDown(d.health,l.HP/l.maxHP*100);c.myShields=this.breakDown(d.health,l.shields/l.maxShields*100);c.distanceToUser=this.breakDown(d.distance,getDistance(k[0],k[1],b[0],b[1]));c.angleToUser=this.breakDown(d.angle,h.cleanAngle(),h);c.angleToGetThere=this.breakDown(d.angle,e.cleanAngle(),e);c.angleAwayFromUser=this.breakDown(d.angle,(h+180).cleanAngle(),h+180);c.angleToGetAwayFromUser=
this.breakDown(d.angle,(e-180).cleanAngle(),e-180);return AI.user}},states:{attack:function(){var a=AI.user.me.gamePlay;AI.steering.toDistance(a.attackRange,function(){AI.steering.faceUser(function(){a.buttonMapping.fi=!0})})},regen:function(){AI.steering.toDistance("high")},kamakazi:function(){function a(){AI.user.me.gamePlay.buttonMapping.up=!0}AI.steering.faceUser(a,a)},spawn:function(){AI.steering.toDistance("high",function(){AI.count.total>=AI.config.maxRobots||AI.count.totalValue>=AI.config.maxValue||
AI.user.me.spawn()})},wander:function(){AI.user.distanceToUser.isLow?AI.steering.flee():AI.steering.wander()},flee:function(){AI.steering.flee()},seek:function(){AI.steering.seek()},nimble:function(){}},steering:{faceUser:function(){var a=arrayifyArguments(arguments);"number"!==typeof a[0]&&a.splice(0,0,0);var b=AI.user,c=b.me.gamePlay.buttonMapping,d=(b.angleToGetThere.value+a[0]).cleanAngle(),b=b.breakDown(AI.config.ranges.angle,d,d.steeringAngle());if(b.isLow){if(a[1])a[1]()}else if(0<b.value?
c.lt=!0:c.rt=!0,b.isMedium)if(a[2])a[2]();else if(a[3])a[3]()},facePoint:function(){var a=arrayifyArguments(arguments);"number"===typeof a[0]&&a.splice(0,2,[a[0],a[1]]);var b=AI.user,c=b.me.gamePlay.buttonMapping,d=b.me.appearance,e=d.position,e=(getStandardAngle(e[0],e[1],a[0][0],a[0][1])-180).cleanAngle(),d=(d.rotate-e).cleanAngle(),b=b.breakDown(AI.config.ranges.angle,d,d.steeringAngle());if(b.isLow){if(a[1])a[1]()}else if(0<b.value?c.lt=!0:c.rt=!0,b.isMedium)if(a[2])a[2]();else if(a[3])a[3]()},
toDistance:function(){function a(){e.dn=!0}function b(){e.up=!0}var c=arrayifyArguments(arguments),d=AI.user,e=d.me.gamePlay.buttonMapping,d=d.distanceToUser.value,k=AI.config.ranges.distance,l=k.tolerance,g={min:0,max:Infinity};"function"===typeof c[1]?c.splice(1,0,!1):"function"===typeof c[0]&&c.splice(0,0,0,!1);if("number"===typeof c[0])g.max=c[0];else if("string"===typeof c[0]){var h=["low","medium","high","massive"],m=h.indexOf(c[0]);m!==h.length-1&&(g.max=k[h[m]]);0!==m&&(g.min=k[h[m-1]])}else updateSome(g,
c[0]);if(d>g.max+l)this.faceUser(b,b);else if(d<g.min-l)c[1]?this.faceUser(180,b,b):this.faceUser(a,a);else if(c[2])c[2]()},toPoint:function(){function a(){k.dn=!0}function b(){k.up=!0}var c=arrayifyArguments(arguments);"number"===typeof c[0]&&c.splice(0,2,[c[0],c[1]]);var d=AI.user,e=d.me.appearance.position,k=d.me.gamePlay.buttonMapping,d=getDistance(e[0],e[1],c[0][0],c[0][1]),e=AI.config.ranges.distance,l=e.tolerance,g={min:0,max:Infinity};"function"===typeof c[2]?c.splice(2,0,!1):"function"===
typeof c[1]&&c.splice(1,0,0,!1);if("number"===typeof c[1])g.max=c[1];else if("string"===typeof c[1]){var h=["low","medium","high","massive"],m=h.indexOf(c[1]);m!==h.length-1&&(g.max=e[h[m]]);0!==m&&(g.min=e[h[m-1]])}else updateSome(g,c[1]);if(d>g.max+l)this.facePoint(c[0],b,b);else if(d<g.min-l)c[2]?this.facePoint(c[0],180,b,b):this.facePoint(c[0],a,a);else if(c[3])c[3]()},flee:function(){this.toDistance("high",!0)},seek:function(a,b){this.toPoint([a,b],0)},wander:function(){function a(){b.wander=
{destination:[rand(0,e),rand(0,k)]};c=b.wander}var b=AI.user.me.gamePlay,c=b.wander,d=variables,e=d.canvas.width,k=d.canvas.height;c||a();this.toPoint(c.destination,"low",a)}},config:{ranges:{angle:{low:6,medium:17,high:45,tolerance:2},distance:{low:200,medium:470,high:880,tolerance:25},health:{low:40,medium:70,high:97},time:{low:15,medium:30,high:60,tolerance:3}},maxRobots:10,maxValue:35},count:{total:0,totalValue:0,lastRespawn:0},win:function(){$("#winner").show().delay(3E3).fadeOut("slow")}};
function Sentry(){return updateSome(new robot,{name:"Sentry",appearance:{shape:["v2.1",{src:"/g/assets/images/robots/orange/tribase2.png"}]},gamePlay:{weaponKeywords:["Lazer"],robotValue:5,damageMultiplier:.5,shieldBurnOut:150,rotateSpeed:6},physics:{mass:1200},user:{username:"Sentry"},ai:{stateStack:["attack"],states:{attack:function(){var a=AI.user;a.me.appearance.shape[1].src="/g/assets/images/robots/orange/tribase2.png";a.myShields.isLow&&a.me.ai.addState("regen")},kamakazi:function(){var a=AI.user;
a.me.appearance.shape[1].src="/g/assets/images/robots/orange/tribase1.png";a.myShields.isMassive&&a.me.ai.removeState()},regen:function(){var a=AI.user;a.me.appearance.shape[1].src="/g/assets/images/robots/orange/tribase2.png";a.myShields.isHigh?a.me.ai.removeState():(a.myHP.isLow||a.myHP.isMedium)&&a.me.ai.addState("kamakazi")}}}})}var updateSome,userObject,getStandardAngle;
function robot(){return updateSome(new userObject,{"class":"robot",appearance:{sizeScale:{2:1*variables.sizeScale}},gamePlay:{maxHP:4E3,rotateSpeed:4,speed:8,damageMultiplier:.5,weaponKeywords:["GrenadeLauncher"],robotValue:1,respawnWait:125,spawns:[],maxShields:500,shieldRegen:3,attackRange:500,lastRespawn:0,shieldBurnOut:200,buttonMapping:{cw:!1,dn:!1,fi:!1,lt:!1,rt:!1,sb:!1,ss:!1,up:!1,sl:!1,sr:!1}},minimalToRender:!1,physics:{mass:250},user:{level:1,availableToPublic:!1,username:"Temporary Battle Prototype",
publicProfileImg:"/g/assets/images/robots/profilePic.jpg"},ai:{stateStack:["attack"],currentState:function(){var a=AI.user.me.ai;return a.stateStack[a.stateStack.length-1]},addState:function(a){var b=AI.user.me.ai;b.stateStack.push(a);return b},removeState:function(){var a=AI.user.me.ai;a.stateStack.pop();return a},changeState:function(a){return AI.user.me.ai.removeState().addState(a)}},die:function(){var a=AI.count,b=this.gamePlay;a[this.name]--;a.total--;a.totalValue-=b.robotValue;this.erase();
delete variables.interactingObjects[this.uid];0===a.total?AI.win():0>=a.total?console.warn("Robot counting error!"):functions.userMessage("UUggggg! You beat me.</br><b>Good Job!</b>","success")},gameCycle:function(){AI.user.get(this);var a=this.ai.currentState();AI.user.stateLog.innerHTML+=(this.user.username||this.name)+": <b>"+a+"</b></br>";if(AI.states[a])AI.states[a]();this.ai.states[a]();updateSome(this,AI.user.me);this.ai.stateStack=AI.user.me.ai.stateStack;this.applyGameLogic();var a=this.gamePlay.buttonMapping,
b;for(b in a)a[b]=!1},isPressed:function(a,b){return b?variables.timeStamp:this.gamePlay.buttonMapping[a]},changeWeapon:function(){var a=this.gamePlay,b=a.weapons[0].gamePlay;a.weapons.move(0,-1);b.cooldown=b.rateOfFire},collideWith:function(a){var b=[this.gamePlay.speed/this.physics.mass],c=this.appearance.position,d=a.appearance.position,e=a.gamePlay;switch(a["class"]){case "projectile":this.takeDamage(a.gamePlay.damage);break;case "userObject":this.takeDamage(e.HP*e.damageMultiplier/variables.reduceRammingDmg);
case "robot":b[1]=getStandardAngle(c[0],c[1],d[0],d[1]).toRadians();b=b.toCartesian();this.physics.velocity[0]+=b[0];this.physics.velocity[1]+=b[1];break;default:console.warn(a["class"],"unknown class of other object")}},spawn:function(){var a=this.gamePlay,b=variables,c=AI.count,d=a.spawns[rand(0,a.spawns.length)];0===a.spawns.length||b.timeStamp-a.lastRespawn<a.respawnWait||(a.lastRespawn=b.timeStamp,a=functions.objectFactory(d,{appearance:{position:this.appearance.position}}),c.totalValue+a.gamePlay.robotValue>
AI.config.maxValue||a.save())},save:function(){variables.interactingObjects[this.uid]=this},onCompleteConstruction:function(){var a=this.gamePlay,b=a.weaponKeywords,c=AI.count;a.weapons=[];for(var d in b)!1===isNaN(parseInt(d,10))&&(a.weapons[d]=functions.objectFactory(b[d]));a.HP=a.maxHP;a.shields=a.maxShields;c[this.name]||(c[this.name]=0);c[this.name]++;c.total++;c.totalValue+=a.robotValue}})}
function MiniCruiser(){return updateSome(new robot,{name:"MiniCruiser",appearance:{shape:["v2.1",{src:"/g/assets/images/robots/orange/cruiser.png"}],sizeScale:{2:.5*variables.sizeScale}},gamePlay:{weaponKeywords:["LittleSister"],robotValue:1,speed:13,rotateSpeed:9,damageMultiplier:.2,maxHP:1E3,maxShields:250,shieldRegen:1.2},physics:{mass:200},user:{username:"Mini Cruiser"},ai:{stateStack:["attack"],states:{attack:function(){var a=AI.user.me;3<=AI.count[a.name]&&a.ai.addState("wander")},wander:function(){var a=
AI.user.me;3>AI.count[a.name]&&a.ai.removeState()}}}})}
function Destroyer(){return updateSome(new robot,{name:"Destroyer",appearance:{shape:["v2.1",{src:"/g/assets/images/robots/orange/destroyer.png"}]},gamePlay:{rotateSpeed:4,weaponKeywords:["Lazer","LittleSister"],robotValue:7,damageMultiplier:.8,shieldBurnOut:150,attackRange:700,maxHP:8E3,maxShields:1E3},physics:{mass:1500},user:{username:"Destroyer"},ai:{stateStack:["attack"],states:{attack:function(){var a=AI.user,b=a.me;a.userShields.isLow&&b.changeWeapon()}}}})}
function modeInit(){variables.singlePlayerMode=!0;AI.user.stateLog=document.getElementById("stateLog");authObject.isOwnerLoggedIn()&&(AI.user.stateLog.style.display="block");resizeCanvas();$("head").append('<link href="https://fonts.googleapis.com/css?family=Righteous" rel="stylesheet">');functions.objectFactory("Mothership",{},{save:!0});clientActivate()}
var resizeCanvas=function f(){var b=variables,c=b.canvas;b.canvasSize=[.95*window.innerWidth,.95*window.innerHeight];c.width=b.canvasSize[0];c.height=b.canvasSize[1];return f};$(window).resize(resizeCanvas);
</script>